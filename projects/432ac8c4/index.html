<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="シンプルで洗練されたタスク管理PWAアプリ。AIによる優先度提案機能付き。">

    <!-- OGP Meta Tags -->
    <meta property="og:title" content="TaskFlow - シンプルなタスク管理アプリ">
    <meta property="og:description" content="シンプルで洗練されたタスク管理PWAアプリ。AIによる優先度提案機能付き。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://vps.nekodigi.com/ccbot/projects/432ac8c4/">
    <meta property="og:image" content="./icons/icon-512.png">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="TaskFlow - シンプルなタスク管理アプリ">
    <meta name="twitter:description" content="シンプルで洗練されたタスク管理PWAアプリ。AIによる優先度提案機能付き。">
    <meta name="twitter:image" content="./icons/icon-512.png">

    <title>TaskFlow - タスク管理</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#2c3e50">
    <link rel="apple-touch-icon" href="./icons/icon-192.png">

    <!-- Styles -->
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading" class="loading-screen">
        <div class="loader"></div>
    </div>

    <!-- Auth Screen -->
    <div id="auth-screen" class="auth-container" style="display:none;">
        <div class="auth-box">
            <h1>TaskFlow</h1>
            <p class="subtitle">シンプルなタスク管理</p>

            <div id="login-form">
                <input type="email" id="login-email" placeholder="メールアドレス" required>
                <input type="password" id="login-password" placeholder="パスワード" required>
                <button id="login-btn" class="btn-primary">ログイン</button>
                <p class="auth-switch">
                    アカウントをお持ちでない方は <a href="#" id="show-register">新規登録</a>
                </p>
            </div>

            <div id="register-form" style="display:none;">
                <input type="email" id="register-email" placeholder="メールアドレス" required>
                <input type="password" id="register-password" placeholder="パスワード（6文字以上）" required>
                <button id="register-btn" class="btn-primary">新規登録</button>
                <p class="auth-switch">
                    すでにアカウントをお持ちの方は <a href="#" id="show-login">ログイン</a>
                </p>
            </div>

            <div id="auth-error" class="error-message" style="display:none;"></div>
        </div>
    </div>

    <!-- Main App Screen -->
    <div id="app-screen" class="app-container" style="display:none;">
        <!-- Header -->
        <header class="app-header">
            <h1>TaskFlow</h1>
            <div class="header-actions">
                <span id="user-email" class="user-email"></span>
                <button id="logout-btn" class="btn-secondary">ログアウト</button>
            </div>
        </header>

        <!-- Task Input Form -->
        <section class="task-form-section">
            <div class="task-form">
                <input type="text" id="task-title" placeholder="タスクのタイトル" required>
                <textarea id="task-description" placeholder="説明（任意）" rows="2"></textarea>

                <div class="form-row">
                    <div class="form-group">
                        <label for="task-deadline">期限</label>
                        <input type="date" id="task-deadline">
                    </div>

                    <div class="form-group">
                        <label for="task-priority">優先度</label>
                        <select id="task-priority">
                            <option value="low">低</option>
                            <option value="medium" selected>中</option>
                            <option value="high">高</option>
                        </select>
                    </div>
                </div>

                <div class="form-actions">
                    <button id="add-task-btn" class="btn-primary">タスクを追加</button>
                    <button id="update-task-btn" class="btn-primary" style="display:none;">タスクを更新</button>
                    <button id="cancel-edit-btn" class="btn-secondary" style="display:none;">キャンセル</button>
                    <button id="ai-suggest-btn" class="btn-ai">AI優先度提案</button>
                </div>

                <div id="ai-suggestion" class="ai-suggestion" style="display:none;">
                    <div class="ai-suggestion-content">
                        <strong>AI提案:</strong>
                        <p id="ai-suggestion-text"></p>
                        <button id="apply-ai-suggestion" class="btn-small">提案を適用</button>
                        <button id="close-ai-suggestion" class="btn-small-secondary">閉じる</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Filters -->
        <section class="filters-section">
            <div class="filters">
                <button class="filter-btn active" data-filter="all">すべて</button>
                <button class="filter-btn" data-filter="active">進行中</button>
                <button class="filter-btn" data-filter="completed">完了済み</button>
                <button class="filter-btn" data-filter="high">優先度: 高</button>
            </div>
        </section>

        <!-- Tasks List -->
        <section class="tasks-section">
            <div id="tasks-container" class="tasks-container">
                <!-- Tasks will be dynamically inserted here -->
            </div>

            <div id="no-tasks" class="no-tasks" style="display:none;">
                <p>タスクがありません</p>
            </div>
        </section>
    </div>

    <!-- Firebase SDK -->
    <script type="module" src="./js/firebase-config.js"></script>
    <script type="module" src="./js/auth.js"></script>
    <script type="module" src="./js/tasks.js"></script>
    <script type="module" src="./js/ai-suggestions.js"></script>
    <script type="module" src="./js/app.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registered:', registration);
                    })
                    .catch(error => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
